# 싱글 스레드 (Single Thread)

'Javascript는 싱글 스레드 프로그래밍 언어다.' 그동안 비동기 처리를 공부하며 이렇게만 외웠지만 정작 싱글 스레드에 대해서는 정확히 알지 못했습니다. 이번 TIL에서는 싱글 스레드와 멀티 스레드를 비교하여 공부하고 정리합니다.

<br>

## 1. 스레드

스레드란 CPU를 이용하는 기본 단위를 말합니다. 풀어서 말하자면 운영체제로부터 자원을 할당받는 작업을 하고(프로세스), 할당받은 자원을 이용하는 실행의 단위입니다. 자체 프로그램 카운터, 스택 및 레지스터 집합으로 구성되어 있습니다.

- 프로그램 카운터: 다음에 실행할 명령어 추적
- 레지스터 집합: 현재 작업 변수 보유
- 스택: 실행 이력 포함

여기서, <b>각 스레드는 프로세스 내에 속하며 프로세스 외부에는 스레드가 존재하지 않습니다.</b>

스레드는 '경량 프로세스'라고도 불리기도 합니다. 그 이유는 아래와 같습니다.

프로세스와 스레드 :
|프로세스|스레드|
|------|---|
실행중인 모든 프로그램|단순히 프로세스의 한 부분
많은 리소스 소비|보다 적은 리소스 소비|
생성과 종료에 많은 시간 소요|상대적으로 적은 시간 소요|
프로세스 간 통신은 많은 시간 소요|스레드 간 통신은 보다 적은 시간 소요|
프로세스 차단 시 나머지 프로세스는 계속 실행 가능|user-level 스레드가 차단되면 해당 피어 스레드도 모두 차단|

위 표를 참고하였을 때 스레드의 장점은
리소스 활용도가 높고 생성 및 관리가 쉽습니다. 또한 시스템의 처리량이 향상됩니다.

위와 같은 이유와 함께, 스레드에는 프로세스 실행을 위한 자체 독립 리소스가 있어 여러 프로세스의 병렬 실행이 가능합니다. 따라서 이를 이용해 애플리케이션의 성능을 향상시키는 데에 널리 사용됩니다.

이제부터는 싱글 스레드와 멀티 스레드에 대해 알아보겠습니다.
싱글 스레드는 하나의 프로세스에서 하나의 스레드를 실행하며, 프로세스는 순차실행됩니다. 반면 멀티 스레드는 하나의 프로세스에서 여러 개의 스레드를 동시에 실행 가능합니다.

![default](../../imgs/image-thread-sin%26mul.png)

<br>

## 2. 싱글 스레드

<b>하나의 프로세스에서 하나의 스레드.</b> 레지스터와 스택 각각 한 개씩으로 표현합니다.
예를 들어 파일 A, B, C를 다운로드 받는다고 하면, 싱글 스레드의 경우 요청을 한 순서대로 하나씩 다운로드할 것입니다.

#### 1-2. 싱글 스레드 장점

- 단일한 스레드이기 때문에 스레드 간 자원 공유가 없음 -> 자원에 대한 동기화를 신경쓰지 않아도 됩니다.
- 멀티스레드에서 발생하는 context switching이 없음 -> 스위칭 시 오버헤드를 방지할 수 있습니다.

위와 같은 이유로, 단순히 CPU만을 사용하는 작업은 싱글 스레드가 멀티 스레드보다 효율적입니다.

#### 1-3. 싱글 스레드 단점

- CPU를 활용하지 못하기 때문에, 프로세스를 최대한 활용하기 위해 다른 모듈 및 인스턴스를 실행시켜야 합니다.

<br>

## 3. 멀티 스레드

프로그램을 다수의 실행단위로 나누어 실행합니다.(프로그램 카운터가 여러 개를 통해 실행됩니다.) 그렇다 보니 싱글 스레드와 달리 여러 개의 스택으로 이루어집니다. 방금의 예시에서라면 A, B, C의 파일을 동시에 번갈아 가며 다운로드할 것입니다.

#### 3-1. 멀티 스레드 장점

- 프로세스의 자원과 상태를 스레드간 공유 -> 효율적으로 작업
- 프로세스와 달리 스레드는 context switching 시 캐시 메모리를 비우지 않아도 됨 -> 작업 전환이 빠름

CPU 이외의 자원을 사용하는 작업의 경우 멀티 스레드가 싱글 스레드보다 효율적입니다.

#### 3-2. 멀티 스레드 단점

- context switching 시 시간이 소요되므로 하나의 스레드만 동작시켜도 될 때에는 오히려 비효율적입니다.
- 공유 자원에 대한 동기화를 신경써주어야 합니다. 과도하게 제어하면 성능저하가 발생할 수도 있습니다.
- 한 스레드가 차단되면 다른 스레드도 차단됩니다.(공유 메모리 사용)

<br>

## Reference

- study tonight: https://www.studytonight.com/operating-system/multithreading
- eunjin.log (싱글스레드, 멀티스레드의 의미): https://velog.io/@eunjin/OS-%EC%8B%B1%EA%B8%80%EC%8A%A4%EB%A0%88%EB%93%9C-%EB%A9%80%ED%8B%B0%EC%8A%A4%EB%A0%88%EB%93%9C%EC%9D%98-%EC%9D%98%EB%AF%B8

<br>
